suppressPackageStartupMessages(library("tibble"))
suppressPackageStartupMessages(library("dplyr"))
suppressPackageStartupMessages(library("plotly"))
suppressPackageStartupMessages(library("ggplot2"))
table1 <- read.csv("/media/sf_AIDD/Results/variant_calling/sub_level/sub_levelfinal.csv", row.names=1)
table4 <- t(table1)
pheno <- read.csv("/media/sf_AIDD/PHENO_DATA.csv", row.names=1)
pheno[, c(1,3)] <- NULL
table5 <- merge(pheno, table4, by="row.names")
table6 <- table5 %>% group_by(set_group) %>% summarise (file_nameavg = mean(file_name), file_namesd = sd(file_name))
write.csv(table6, "/media/sf_AIDD/Results/variant_calling/sub_level/largegraph/file_namemeansd.csv", row.names=FALSE)
tiff("/media/sf_AIDD/Results/variant_calling/sub_level/file_namemean.tiff", units="in", width=10, height=10, res=600)
p <- ggplot(table6, aes(set_x, y=file_nameavg, set_fill)) + geom_bar(stat="identity", color="black", position=position_dodge()) + geom_errorbar(aes(ymin=file_nameavg-file_namesd, ymaset_x+file_namesd), position=position_dodge()) + scale_fill_manual(values=c(set_barcolors)) + theme_minimal() + theme(legend.position="bottom") +
  labs(x="level of interest", y="mRNA expression counts normalized for coverage at each sub_level", color="set_group") + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())
p
dev.off()
