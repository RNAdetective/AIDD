#!/usr/bin/env bash
main_function() {
export PATH=/media/sf_AIDD:/home/user/AIDD/AIDD_tools/bin

echo "Now creating folder directory system for your experiment."
## this creates directories to store results from stringtie and further downstream analysis
for i in Counts ballgown_in ballgown Results working_directory alignment_metrics fastqc recalibration_plots insert_metrics snpEFF vcf_files logs bam_files; do
    mkdir /media/sf_AIDD/$i/
done
## this creates subdirectories in results
for i in DESeq2 topGO heatmaps gene_of_interest variant_calling variant_calling_mutech2; do
    mkdir /media/sf_AIDD/Results/$i/
done
## this creates subdirectories for DESeq2 and topGO and variant calling
for i in gene_level transcript_level; do
    mkdir /media/sf_AIDD/Results/DESeq2/$i/
    mkdir /media/sf_AIDD/Results/topGO/$i/
    mkdir /media/sf_AIDD/Results/variant_calling/$i/
    mkdir /media/sf_AIDD/Results/variant_calling_mutech2/$i/
    mkdir /media/sf_AIDD/Results/heatmaps/$i/
done
## this creates subdirectories in DESeq2/gene and DESeq2/transcript
for i in counts differential_expression; do
    mkdir /media/sf_AIDD/Results/DESeq2/gene/$i/
    mkdir /media/sf_AIDD/Results/DESeq2/transcript/$i/
done
## this creates subdirectories in variant_calling
for i in nt_sub codon_sub high_impact freq; do
    mkdir /media/sf_AIDD/Results/variant_calling/gene_level/$i/
    mkdir /media/sf_AIDD/Results/variant_calling/transcript_level/$i/
    mkdir /media/sf_AIDD/Results/variant_calling_mutech2/gene_level/$i/
    mkdir /media/sf_AIDD/Results/variant_calling_mutech2/transcript_level/$i/
done
## this creates subdirectories in variant_calling/.../high_impact
for i in topGO vennD counts; do
    mkdir /media/sf_AIDD/Results/variant_calling/gene_level/high_impact/$i/
    mkdir /media/sf_AIDD/Results/variant_calling/transcript_level/high_impact/$i/
    mkdir /media/sf_AIDD/Results/variant_calling_mutech2/gene_level/high_impact/$i/
    mkdir /media/sf_AIDD/Results/variant_calling_mutech2/transcript_level/high_impact/$i/
done
##this creates subdirectories for python script to convert to gene_count_matrix for DESeq2
INPUT=/media/sf_AIDD/working_directory/PHENO_DATA.csv
OLDIFS=$IFS
IFS=,
[ ! -f $INPUT ] && { echo "$INPUT file not found"; exit 99; }
while read  x run condition sample t_name2
do
    mkdir /media/sf_AIDD/ballgown/$sample/
done < $INPUT
IFS=$OLDIFS
##this creates subdirectories for ballgown analysis
INPUT=/media/sf_AIDD/working_directory/PHENO_DATA.csv
OLDIFS=$IFS
IFS=,
[ ! -f $INPUT ] && { echo "$INPUT file not found"; exit 99; }
while read  x run condition sample t_name2
do
    mkdir /media/sf_AIDD/ballgown_in/$sample/
done < $INPUT
IFS=$OLDIFS
}
main_function 2>&1 | tee -a /media/sf_AIDDlogs/foldersystem.log
