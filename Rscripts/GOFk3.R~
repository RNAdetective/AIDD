library("ggplot2")
library("plyr")
## this creates tables for bargraphs
results <- read.csv("resultsall.csv")
colnames(results)[c(1)] <- c("gene_name")
GCMedit <- read.csv("gene_count_matrixedited.csv")
folder <- "/home/user/AIDD/gene_list/DESeq2G/"
files <- list.files(path=folder, pattern="*.csv") # create list of all .csv files in folder
# read in each .csv file in files and rbind them into a data frame called data 
data <- 
do.call("rbind", 
          lapply(files, 
                 function(x) 
                 read.csv(paste(folder, x, sep=''), 
                 stringsAsFactors = FALSE)))
table <- merge(data, GCMedit, by="gene_name", sort=F)
RGtable <- merge(table, results, by="gene_name", sort=F)
RGtable2 <- t(RGtable)
colnames(RGtable2) <- RGtable[,1]
RGtable3 <- RGtable2[-c(1, 2, 21, 22, 23, 24, 25, 26), ]
write.csv(RGtable3, "RGtable3.csv")
RGtable3 <- read.csv("RGtable3.csv")
colnames(RGtable3)[1] <- "sample"
Data <- read.csv("PHENO_DATAk3.csv")
RGtable4 <- merge(Data, RGtable3, by="sample", sort=F)
ALL <- aggregate(RGtable4[, 9:11], list(RGtable4$condition), mean)
ALL1 <- t(ALL)
ALL2 <- ALL1[-c(1),]
write.csv(ALL2, "5.csv")
write.csv(ALL2, "6.csv")
ALL5 <- read.csv("5.csv")
colnames(ALL5)[1] <- "gene_name"
ALLG <- ALL5$V2 <- NULL
colnames(ALL5)[2] <- "counts"
ALL6 <- read.csv("6.csv")
ALLE <- colnames(ALL6)[1] <- "gene_name"
ALLH <- ALL6$V1 <- NULL
ALLI <- colnames(ALL6)[2] <- "counts"
ALL5["condition"] <- "AML"
ALL6["condition"] <- "Normal"
final <- rbind(ALL5, ALL6)
tiff("VEGFGene.tiff")
ggplot(final, aes(x=gene_name, y=counts, fill=condition)) +
    geom_bar(stat="identity", position=position_dodge(), colour="black")
dev.off()
colnames(ALL5)[2] <- "MeanAML"
colnames(ALL6)[2] <- "MeanNormal"
ALL5$condition <- NULL
ALL6$condition <- NULL
mergetable <- merge(ALL5, ALL6, by="gene_name")
allfinal <- merge(mergetable, RGtable, by="gene_name")
allfinal2 <- allfinal[,-c(4:19)]
write.csv(allfinal2, "VEGFGene.csv", row.names=FALSE)
sessionInfo()
##VEGF final count tables
table1 <- read.csv("gene_count_matrixedited.csv")
table2 <- read.csv("VEGFgene.csv")
table3 <- merge(table2, table1, by="gene_name")
table4 <- table3$gene_id <- NULL
table5 <- colnames(table3)[c(2:19)] <- rownames(Data)[c(1:18)]
tableB12 <- read.csv("resultsall.csv")
table5 <- colnames(tableB12)[c(1)] <- c("gene_name")
head(tableB12)
tableC6 <- merge(table3, tableB12, by="gene_name")
write.csv(tableC6, "resultsVEGF_gene_counts.csv", row.names=FALSE)
Data <- read.csv("bargraphindexZika.csv")
tablebargraph <- t(tableC6)
colnames(tablebargraph) <- tableC6[,1]
tablebargraph2 <- tablebargraph[-c(1, 20, 21, 22, 23, 24, 25), ]
write.csv(tablebargraph2, "tablebargraph2.csv")
tablebargraph2 <- read.csv("tablebargraph2.csv")
tablebargraphY <- colnames(tablebargraph2)[1] <- "gene_name"
tablebargraph2
tablebargraph3 <- merge(Data, tablebargraph2, by="gene_name")
tablebargraph4 <- aggregate(tablebargraph3[, 3:5], list(tablebargraph3$sample), mean)
tablebargraph5 <- t(tablebargraph4)
tablebargraph5 <- tablebargraph5[-c(1),]
write.csv(tablebargraph5, "5.csv")
write.csv(tablebargraph5, "6.csv")
write.csv(tablebargraph5, "7.csv")
tablebargraph5 <- read.csv("5.csv")
tablebargraphF <- colnames(tablebargraph5)[1] <- "gene_name"
tablebargraphG <- tablebargraph5$V2 <- NULL
tablebargraphG1 <- tablebargraph5$V3 <- NULL
tablebargraph6 <- read.csv("6.csv")
tablebargraphE <- colnames(tablebargraph6)[1] <- "gene_name"
tablebargraphH <- tablebargraph6$V1 <- NULL
tablebargraphH1 <- tablebargraph6$V3 <- NULL
tablebargraph7 <- read.csv("7.csv")
tablebargraphZ <- colnames(tablebargraph7)[1] <- "gene_name"
tablebargraphX <- tablebargraph7$V1 <- NULL
tablebargraphX1 <- tablebargraph7$V2 <- NULL
tablebargraphI <- colnames(tablebargraph6)[2] <- "V1"
tablebargraphZZ <- colnames(tablebargraph7)[2] <- "V1"
tablebargraph5["condition"] <- "A"
tablebargraph6["condition"] <- "B"
final <- rbind(tablebargraph5, tablebargraph6)
tiff("VEGFbargraph.tiff")
ggplot(final, aes(x=g_name, y=V1, fill=condition)) +
    geom_bar(stat="identity", position=position_dodge(), colour="black")
dev.off()
##ADAR final count table K048
table1 <- read.csv("K048gene_count_matrix.csv")
table2 <- read.csv("ADARgene.csv")
table3 <- merge(table2, table1, by="gene_name")
table4 <- table3$gene_id <- NULL
table5 <- colnames(table3)[c(2:19)] <- rownames(Data)[c(1:18)]
tableC3 <- merge(table3, tableB12, by="gene_name")
write.csv(tableC3, "K048resultsADAR_gene_counts.csv", row.names=FALSE)
Data <- read.csv("bargraphindexK048.csv")
tablebargraph <- t(tableC3)
colnames(tablebargraph) <- tableC3[,1]
tablebargraph2 <- tablebargraph[-c(1,18, 19, 20, 21, 22, 23), ]
write.csv(tablebargraph2, "tablebargraph2.csv")
tablebargraph2 <- read.csv("tablebargraph2.csv")
tablebargraphY <- colnames(tablebargraph2)[1] <- "gene_name"
tablebargraph2
tablebargraph3 <- merge(Data, tablebargraph2, by="gene_name")
tablebargraph4 <- aggregate(tablebargraph3[, 3:5], list(tablebargraph3$sample), mean)
tablebargraph5 <- t(tablebargraph4)
tablebargraph5 <- tablebargraph5[-c(1),]
write.csv(tablebargraph5, "5.csv")
write.csv(tablebargraph5, "6.csv")
tablebargraph5 <- read.csv("5.csv")
tablebargraphF <- colnames(tablebargraph5)[1] <- "gene_name"
tablebargraphG <- tablebargraph5$V2 <- NULL
tablebargraphM <- colnames(tablebargraph5)[2] <- "V1"
tablebargraph6 <- read.csv("6.csv")
tablebargraphE <- colnames(tablebargraph6)[1] <- "gene_name"
tablebargraphH <- tablebargraph6$V1 <- NULL
tablebargraphI <- colnames(tablebargraph6)[2] <- "V1"
tablebargraph5["condition"] <- "A"
tablebargraph6["condition"] <- "B"
final <- rbind(tablebargraph5, tablebargraph6)
tiff("K048ADARbargraph.tiff")
ggplot(final, aes(x=gene_name, y=V1, fill=condition)) +
    geom_bar(stat="identity", position=position_dodge(), colour="black")
dev.off()
##ADAR final count table K054
table1 <- read.csv("K054gene_count_matrix.csv")
table2 <- read.csv("ADARgene.csv")
table3 <- merge(table2, table1, by="gene_name")
table4 <- table3$gene_id <- NULL
table5 <- colnames(table3)[c(2:19)] <- rownames(Data)[c(1:18)]
tableC3 <- merge(table3, tableB12, by="gene_name")
write.csv(tableC3, "K054resultsADAR_gene_counts.csv", row.names=FALSE)
Data <- read.csv("bargraphindexK054.csv")
tablebargraph <- t(tableC3)
colnames(tablebargraph) <- tableC3[,1]
tablebargraph2 <- tablebargraph[-c(1,18, 19, 20, 21, 22, 23), ]
write.csv(tablebargraph2, "tablebargraph2.csv")
tablebargraph2 <- read.csv("tablebargraph2.csv")
tablebargraphY <- colnames(tablebargraph2)[1] <- "gene_name"
tablebargraph2
tablebargraph3 <- merge(Data, tablebargraph2, by="gene_name")
tablebargraph4 <- aggregate(tablebargraph3[, 3:5], list(tablebargraph3$sample), mean)
tablebargraph5 <- t(tablebargraph4)
tablebargraph5 <- tablebargraph5[-c(1),]
write.csv(tablebargraph5, "5.csv")
write.csv(tablebargraph5, "6.csv")
tablebargraph5 <- read.csv("5.csv")
tablebargraphF <- colnames(tablebargraph5)[1] <- "gene_name"
tablebargraphG <- tablebargraph5$V2 <- NULL
tablebargraphM <- colnames(tablebargraph5)[2] <- "V1"
tablebargraph6 <- read.csv("6.csv")
tablebargraphE <- colnames(tablebargraph6)[1] <- "gene_name"
tablebargraphH <- tablebargraph6$V1 <- NULL
tablebargraphI <- colnames(tablebargraph6)[2] <- "V1"
tablebargraph5["condition"] <- "A"
tablebargraph6["condition"] <- "B"
final <- rbind(tablebargraph5, tablebargraph6)
tiff("K054ADARbargraph.tiff")
ggplot(final, aes(x=gene_name, y=V1, fill=condition)) +
    geom_bar(stat="identity", position=position_dodge(), colour="black")
dev.off()
##ADAR final count table G010
table1 <- read.csv("G010gene_count_matrix.csv")
table2 <- read.csv("ADARgene.csv")
Data <- read.csv("bargraphindexG010.csv", row.names=1)
table3 <- merge(table2, table1, by="gene_name")
table4 <- table3$gene_id <- NULL
table5 <- colnames(table3)[c(2:7)] <- rownames(Data)[c(1:6)]
tableC3 <- merge(table3, tableB12, by="gene_name")
write.csv(tableC3, "G010resultsADAR_gene_counts.csv", row.names=FALSE)
tablebargraph <- t(tableC3)
colnames(tablebargraph) <- tableC3[,1]
tablebargraph2 <- tablebargraph[-c(1, 8, 9, 10, 11, 12, 13), ]
write.csv(tablebargraph2, "tablebargraph2.csv")
tablebargraph2 <- read.csv("tablebargraph2.csv")
tablebargraphY <- colnames(tablebargraph2)[1] <- "gene_name"
tablebargraph2
tablebargraph4 <- aggregate(tablebargraph2[, 2:4], list(tablebargraph2$gene_name), mean)
tablebargraph5 <- t(tablebargraph4)
write.csv(tablebargraph5, "5.csv", row.names=FALSE)
write.csv(tablebargraph5, "6.csv", row.names=FALSE)
tablebargraph5 <- read.csv("5.csv")
tablebargraphF <- colnames(tablebargraph5)[1] <- "gene_name"
tablebargraphG <- tablebargraph5$V2 <- NULL
tablebargraphM <- colnames(tablebargraph5)[2] <- "V1"
tablebargraph6 <- read.csv("6.csv")
tablebargraphE <- colnames(tablebargraph6)[1] <- "gene_name"
tablebargraphH <- tablebargraph6$V1 <- NULL
tablebargraphI <- colnames(tablebargraph6)[2] <- "V1"
tablebargraph5["condition"] <- "A"
tablebargraph6["condition"] <- "B"
final <- rbind(tablebargraph5, tablebargraph6)
tiff("G010ADARbargraph.tiff")
ggplot(final, aes(x=gene_name, y=V1, fill=condition)) +
    geom_bar(stat="identity", position=position_dodge(), colour="black")
dev.off()
sessionInfo()
